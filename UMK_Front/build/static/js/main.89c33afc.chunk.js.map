{"version":3,"sources":["Components/TopButton/index.js","Pages/routes.js","Pages/index.js","Utils/i18n.js","index.js","Service/http.js","Utils/notify.js","Components/TopButton/topButton.module.css","State/user.js","Service/auth.js"],"names":["TopButton","t","useTranslation","useState","show","setShow","handleScroll","window","scrollY","useEffect","addEventListener","removeEventListener","className","styles","Scroll_Top_button","onClick","scrollTo","top","behavior","title","xmlns","version","x","y","fill","viewBox","enableBackground","d","Scroll_Down_button","document","body","scrollHeight","transform","MainPage","lazy","UMKPage","LoginPage","ViewPage","routes","path","appName","element","Routes","useRoutes","IndexPage","navigate","useNavigate","i18n","setUser","useSetRecoilState","userState","Loading","setLoading","pathname","useLocation","http","interceptors","request","use","config","params","lang","language","error","console","log","Promise","reject","response","data","status","undefined","JSON","parse","stringify","message","location","includes","isAuthenticated","isLoading","url","notify","AuthService","check","then","search","id","resources","ru","cm","commonTranslationRU","umk","kg","commonTranslationKG","en","commonTranslationEN","Backend","LanguageDetector","initReactI18next","init","fallbackLng","debug","defaultNS","detection","order","cache","lookupQuerystring","lookupCookie","lookupLocalStorage","interpolation","escapeValue","ReactDOM","render","StrictMode","fallback","getElementById","apiURL","baseURL","axios","create","timeout","headers","toast","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","module","exports","atom","key","default","login","a","password","post","logout","get"],"mappings":"4RAQe,SAASA,IACtB,IAAQC,EAAMC,cAAND,EACR,EAAwBE,oBAAS,GAAjC,mBAAOC,EAAP,KAAaC,EAAb,KAEMC,EAAe,WACfC,OAAOC,QAAU,IACnBH,GAAQ,GAERA,GAAQ,IAwBZ,OAPAI,qBAAU,WAER,OADAF,OAAOG,iBAAiB,SAAUJ,GAC3B,WACLC,OAAOI,oBAAoB,SAAUL,MAEtC,IAECF,EAEA,qCACE,wBACEQ,UAAWC,IAAOC,kBAClBC,QAzBY,WAClBR,OAAOS,SAAS,CACdC,IAAK,EACLC,SAAU,YAuBNC,MAAOlB,EAAE,SAHX,SAKE,qBACEmB,MAAM,6BACNC,QAAQ,MACRC,EAAE,MACFC,EAAE,MACFC,KAAK,OACLC,QAAQ,gBACRC,iBAAiB,oBAPnB,SASE,4BACE,sBAAMC,EAAE,6LAId,wBACEf,UAAWC,IAAOe,mBAClBb,QAtCa,WACnBR,OAAOS,SAAS,CACdC,IAAKY,SAASC,KAAKC,aACnBb,SAAU,YAoCNC,MAAOlB,EAAE,UAHX,SAKE,qBACEmB,MAAM,6BACNC,QAAQ,MACRC,EAAE,MACFC,EAAE,MACFC,KAAK,OACLQ,UAAU,cACVP,QAAQ,gBACRC,iBAAiB,oBARnB,SAUE,4BACE,sBAAMC,EAAE,gMAOb,K,oCClFHM,EAAWC,gBAAK,kBAAM,iCACtBC,EAAUD,gBAAK,kBAAM,uDACrBE,EAAYF,gBAAK,kBAAM,iCACvBG,EAAWH,gBAAK,kBAAM,uDAEfI,EAAS,CACpB,CACEC,KAAK,GAAD,OAAKC,IAAL,KACJC,QAAS,cAACR,EAAD,KAEX,CACEM,KAAK,GAAD,OAAKC,IAAL,UACJC,QAAS,cAACN,EAAD,KAEX,CACEI,KAAK,GAAD,OAAKC,IAAL,SACJC,QAAS,cAACJ,EAAD,KAEX,CACEE,KAAK,GAAD,OAAKC,IAAL,UACJC,QAAS,cAACL,EAAD,KAEX,CACEG,KAAK,IACLE,QAAS,cAACL,EAAD,MCfPM,EAAS,WAEb,OADiBC,YAAUL,IAId,SAASM,IACtB,IAAMC,EAAWC,cACjB,EAAoB5C,cAAZD,EAAR,EAAQA,EAAG8C,EAAX,EAAWA,KACLC,EAAUC,YAAkBC,KAClC,EAA8B/C,oBAAS,GAAvC,mBAAOgD,EAAP,KAAgBC,EAAhB,KACQC,EAAaC,cAAbD,SAmFR,OAjFA5C,qBAAU,WACR8C,IAAKC,aAAaC,QAAQC,KACxB,SAACC,GAKC,OAJAA,EAAOC,OAAP,2BACKD,EAAOC,QADZ,IAEEC,KAAMd,EAAKe,WAENH,KAET,SAACI,GAEC,OADAC,QAAQC,IAAIF,GACLG,QAAQC,OAAOJ,MAI1BR,IAAKC,aAAaY,SAASV,KACzB,SAACU,GAEC,OADU,2BAAQA,EAASC,MAAjB,IAAuBC,OAAQF,EAASE,YAGpD,SAACP,GAAW,IAAD,QAsBP,MArBF,QAAuBQ,IAAnBR,EAAMK,SAGR,OAA2B,OADTI,KAAKC,MAAMD,KAAKE,UAAUX,IAC5BO,OACP,CACLA,OAAQ,IACRK,QAAS1E,EAAE,uBACX8D,OAAO,EACPM,KAAM,MAGH,CACLC,OAAQ,IACRK,QAAS1E,EAAE,sBACX8D,OAAO,EACPM,KAAM,MAGV,GAC6B,OAA3B,UAAAN,EAAMK,gBAAN,eAAgBE,UAC6C,KAAvD,QAAN,EAAA/D,cAAA,mBAAQqE,gBAAR,mBAAkBvB,gBAAlB,eAA4BwB,SAA5B,UAAwCrC,IAAxC,cAGAQ,EAAQ,CAAE8B,iBAAiB,EAAOT,KAAM,KAAMU,WAAW,IACzDlC,EAAS,GAAD,OAAIL,IAAJ,YAEqD,KAApD,OAALuB,QAAK,IAALA,GAAA,UAAAA,EAAOK,gBAAP,mBAAiBT,cAAjB,mBAAyBqB,WAAzB,eAA8BH,SAAS,gBAGzC,MADAI,YAAOhF,EAAE,wBAAyB,SAC5B,gGAOV,OADU,2BAAQ8D,EAAMK,SAASC,MAAvB,IAA6BC,OAAQP,EAAMK,SAASE,YAKlEtB,EAAQ,CAAE8B,iBAAiB,EAAOT,KAAM,KAAMU,WAAW,IACzDG,IAAYC,QAAQC,MAAK,YAAuC,IAIvD,MAJmBf,EAAmC,EAAnCA,KAAMN,EAA6B,EAA7BA,MAAOY,EAAsB,EAAtBA,QAAsB,EAAbL,OAC5CP,GACFf,EAAQ,CAAE8B,iBAAiB,EAAOT,KAAM,KAAMU,WAAW,IACzDE,YAAON,EAAS,WAEhBM,YAAON,EAAS,WAChB3B,EAAQ,CAAE8B,iBAAiB,EAAMT,OAAMU,WAAW,IAClD,UAAIxE,cAAJ,iBAAI,EAAQqE,gBAAZ,iBAAI,EAAkBvB,gBAAtB,OAAI,EAA4BwB,SAA5B,UAAwCrC,IAAxC,WAEFK,EAAS,GAAD,OAAIL,IAAJ,MAGRK,EAAS,GAAD,OAAIQ,GAAJ,OAAe9C,OAAOqE,SAASS,UAG3CjC,GAAW,QAEZ,IAECD,EACK,8BAAMlD,EAAE,aAGf,sBAAKW,UAAU,OAAO0E,GAAG,OAAzB,UACE,cAAC,EAAD,IACA,cAACtF,EAAD,O,mEClGAuF,EAAY,CAEhBC,GAAI,CACFC,GAAIC,EACJC,I,OAEFC,GAAI,CACFH,GAAII,EACJF,I,OAEFG,GAAI,CACFL,GAAIM,EACJJ,I,QAIJ5C,IAEGW,IAAIsC,KAEJtC,IAAIuC,KAEJvC,IAAIwC,KACJC,KAAK,CACJZ,YAEAa,YAAa,KACbC,OAAO,EACPC,UAAW,KAEXC,UAAW,CACTC,MAAO,CAAC,cAAe,SAAU,gBACjCC,MAAO,CAAC,SAAU,gBAClBC,kBAAmB,OACnBC,aAAc,OACdC,mBAAoB,QAEtBC,cAAe,CACbC,aAAa,KAIJ/D,EAAf,EC3BAgE,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,WAAD,CAAUC,SAAU,sFAApB,SACE,cAAC,IAAD,UAGE,cAAC,IAAD,UACE,sBAAKtG,UAAU,MAAf,UACE,cAAC,IAAD,UACE,cAAC,EAAD,MAEF,cAAC,IAAD,eAMViB,SAASsF,eAAe,U,gCC7C1B,2HAGM3E,EAAU,UACV4E,EAAM,OACN/F,EAAO,OACPgG,EAAO,UALG,IAKH,OAAgB7E,GAAhB,OAA0B4E,GAA1B,OAAmC/F,GAE5CkC,EAAO+D,IAAMC,OAAO,CACtBF,QAAQ,GAAD,OARO,IAQP,OAAe7E,GAAf,OAAyB4E,GAAzB,OAAkC/F,GACzCmG,QAAS,IACTC,QAAS,CACP,eAAgB,sBAILlE,O,gCChBf,8CAEO,SAAS0B,EAAON,GAA8B,IAArBL,EAAoB,uDAAX,UAUvC,OATAoD,IAAMpD,GAAQK,EAAS,CACrBgD,SAAU,YACVC,UAAW,IACXC,iBAAiB,EACjBC,cAAc,EACdC,cAAc,EACdC,WAAW,EACXC,cAAU1D,IAEL,I,mBCXT2D,EAAOC,QAAU,CAAC,kBAAoB,qCAAqC,mBAAqB,wC,gCCDhG,8CASajF,EAAYkF,YAAK,CAC5BC,IAAK,YACLC,QARkB,CAClBxD,iBAAiB,EACjBC,WAAW,EACXV,KAAM,S,uGCJFkE,EAAK,uCAAG,+BAAAC,EAAA,6DAASD,EAAT,EAASA,MAAOE,EAAhB,EAAgBA,SAAhB,SACNlF,IAAKmF,KAAK,aAAc,CAAEH,QAAOE,aAD3B,mFAAH,sDAGLtD,EAAK,uCAAG,sBAAAqD,EAAA,sEAAkBjF,IAAKmF,KAAK,cAA5B,mFAAH,qDAELC,EAAM,uCAAG,sBAAAH,EAAA,sEAAkBjF,IAAKqF,IAAI,eAA3B,mFAAH,qDAEC1D,EAAc,CACzBqD,QACApD,QACAwD,W","file":"static/js/main.89c33afc.chunk.js","sourcesContent":["//goto top button\r\n// Language: javascript\r\n// Path: UMK_Front\\src\\Components\\topButton.js\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport styles from \"./topButton.module.css\";\r\n\r\nexport default function TopButton() {\r\n  const { t } = useTranslation();\r\n  const [show, setShow] = useState(false);\r\n\r\n  const handleScroll = () => {\r\n    if (window.scrollY > 100) {\r\n      setShow(true);\r\n    } else {\r\n      setShow(false);\r\n    }\r\n  };\r\n\r\n  const scrollToTop = () => {\r\n    window.scrollTo({\r\n      top: 0,\r\n      behavior: \"smooth\",\r\n    });\r\n  };\r\n  const scrollToDown = () => {\r\n    window.scrollTo({\r\n      top: document.body.scrollHeight,\r\n      behavior: \"smooth\",\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"scroll\", handleScroll);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", handleScroll);\r\n    };\r\n  }, []);\r\n\r\n  if (show) {\r\n    return (\r\n      <>\r\n        <button\r\n          className={styles.Scroll_Top_button}\r\n          onClick={scrollToTop}\r\n          title={t(\"goTop\")}\r\n        >\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            version=\"1.1\"\r\n            x=\"0px\"\r\n            y=\"0px\"\r\n            fill=\"#fff\"\r\n            viewBox=\"0 0 1000 1000\"\r\n            enableBackground=\"new 0 0 1000 1000\"\r\n          >\r\n            <g>\r\n              <path d=\"M545.6,233l425.5,439.8c25.2,26,25.2,68.2,0,94.3c-25.2,26-66,26-91.2,0L500,374.3L120.1,767c-25.2,26-66,26-91.2,0c-25.2-26-25.2-68.2,0-94.3L454.4,233C479.6,207,520.4,207,545.6,233z\" />\r\n            </g>\r\n          </svg>\r\n        </button>\r\n        <button\r\n          className={styles.Scroll_Down_button}\r\n          onClick={scrollToDown}\r\n          title={t(\"goDown\")}\r\n        >\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            version=\"1.1\"\r\n            x=\"0px\"\r\n            y=\"0px\"\r\n            fill=\"#fff\"\r\n            transform=\"rotate(180)\"\r\n            viewBox=\"0 0 1000 1000\"\r\n            enableBackground=\"new 0 0 1000 1000\"\r\n          >\r\n            <g>\r\n              <path d=\"M545.6,233l425.5,439.8c25.2,26,25.2,68.2,0,94.3c-25.2,26-66,26-91.2,0L500,374.3L120.1,767c-25.2,26-66,26-91.2,0c-25.2-26-25.2-68.2,0-94.3L454.4,233C479.6,207,520.4,207,545.6,233z\" />\r\n            </g>\r\n          </svg>\r\n        </button>\r\n      </>\r\n    );\r\n  }\r\n  return null;\r\n}\r\n","import React, { lazy } from \"react\";\r\nimport { appName } from \"../Service/http\";\r\n\r\nconst MainPage = lazy(() => import(\"./MainPage\"));\r\nconst UMKPage = lazy(() => import(\"./UMKPage\"));\r\nconst LoginPage = lazy(() => import(\"./LoginPage\"));\r\nconst ViewPage = lazy(() => import(\"./ViewPage\"));\r\n\r\nexport const routes = [\r\n  {\r\n    path: `${appName}/`,\r\n    element: <MainPage />,\r\n  },\r\n  {\r\n    path: `${appName}/umk/*`,\r\n    element: <UMKPage />,\r\n  },\r\n  {\r\n    path: `${appName}/view`,\r\n    element: <ViewPage />,\r\n  },\r\n  {\r\n    path: `${appName}/login`,\r\n    element: <LoginPage />,\r\n  },\r\n  {\r\n    path: `*`,\r\n    element: <LoginPage />,\r\n  },\r\n];\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRoutes, useNavigate, useLocation } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSetRecoilState } from \"recoil\";\r\n\r\nimport TopButton from \"../Components/TopButton\";\r\nimport { http, appName } from \"../Service/http\";\r\nimport { notify } from \"../Utils/notify\";\r\nimport { AuthService } from \"../Service/auth\";\r\nimport { userState } from \"../State/user\";\r\nimport { routes } from \"./routes\";\r\n\r\nconst Routes = () => {\r\n  const elements = useRoutes(routes);\r\n  return elements;\r\n};\r\n\r\nexport default function IndexPage() {\r\n  const navigate = useNavigate();\r\n  const { t, i18n } = useTranslation();\r\n  const setUser = useSetRecoilState(userState);\r\n  const [Loading, setLoading] = useState(true);\r\n  const { pathname } = useLocation();\r\n\r\n  useEffect(() => {\r\n    http.interceptors.request.use(\r\n      (config) => {\r\n        config.params = {\r\n          ...config.params,\r\n          lang: i18n.language,\r\n        };\r\n        return config;\r\n      },\r\n      (error) => {\r\n        console.log(error);\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    http.interceptors.response.use(\r\n      (response) => {\r\n        const data = { ...response.data, status: response.status };\r\n        return data;\r\n      },\r\n      (error) => {\r\n        if (error.response === undefined) {\r\n          // server is not responding\r\n          let errorObject = JSON.parse(JSON.stringify(error));\r\n          if (errorObject.status === null) {\r\n            return {\r\n              status: 521,\r\n              message: t(\"axios.internetError\"),\r\n              error: true,\r\n              data: null,\r\n            };\r\n          }\r\n          return {\r\n            status: 522,\r\n            message: t(\"axios.unknownError\"),\r\n            error: true,\r\n            data: null,\r\n          };\r\n        }\r\n        if (\r\n          error.response?.status === 401 &&\r\n          window?.location?.pathname?.includes(`${appName}/login`) === false\r\n        ) {\r\n          // user is not authenticated\r\n          setUser({ isAuthenticated: false, data: null, isLoading: false });\r\n          navigate(`${appName}/login`);\r\n\r\n          if (error?.response?.config?.url?.includes(\"auth/check\") === false) {\r\n            // user is not on login page and not on auth/check , session is expired when user is working\r\n            notify(t(\"axios.sessionExpired\"), \"error\");\r\n            throw \"Срок сессии истек!\";\r\n          }\r\n\r\n          // return Promise.reject(error);\r\n        }\r\n\r\n        const data = { ...error.response.data, status: error.response.status };\r\n        return data;\r\n      }\r\n    );\r\n\r\n    setUser({ isAuthenticated: false, data: null, isLoading: true });\r\n    AuthService.check().then(({ data, error, message, status }) => {\r\n      if (error) {\r\n        setUser({ isAuthenticated: false, data: null, isLoading: false });\r\n        notify(message, \"error\");\r\n      } else {\r\n        notify(message, \"success\");\r\n        setUser({ isAuthenticated: true, data, isLoading: false });\r\n        if (window?.location?.pathname?.includes(`${appName}/login`)) {\r\n          // if in login page and auth=true\r\n          navigate(`${appName}/`);\r\n        } else {\r\n          // if not in login page and auth=true\r\n          navigate(`${pathname}${window.location.search}`);\r\n        }\r\n      }\r\n      setLoading(false);\r\n    });\r\n  }, []);\r\n\r\n  if (Loading) {\r\n    return <div>{t(\"loading\")}</div>;\r\n  }\r\n  return (\r\n    <div className=\"Page\" id=\"Page\">\r\n      <Routes />\r\n      <TopButton />\r\n    </div>\r\n  );\r\n}\r\n","import i18n from \"i18next\";\r\nimport Backend from \"i18next-http-backend\";\r\nimport LanguageDetector from \"i18next-browser-languagedetector\";\r\nimport { initReactI18next } from \"react-i18next\";\r\n\r\n// файлы языков\r\nimport commonTranslationRU from \"../Locales/ru/common.json\";\r\nimport commonTranslationKG from \"../Locales/kg/common.json\";\r\nimport commonTranslationEN from \"../Locales/en/common.json\";\r\nimport umkTranslationRU from \"../Locales/ru/umk.json\";\r\nimport umkTranslationKG from \"../Locales/kg/umk.json\";\r\nimport umkTranslationEN from \"../Locales/en/umk.json\";\r\n\r\nconst resources = {\r\n  // cm - namepsace, https://www.i18next.com/principles/namespaces\r\n  ru: {\r\n    cm: commonTranslationRU,\r\n    umk: umkTranslationRU,\r\n  },\r\n  kg: {\r\n    cm: commonTranslationKG,\r\n    umk: umkTranslationKG,\r\n  },\r\n  en: {\r\n    cm: commonTranslationEN,\r\n    umk: umkTranslationEN,\r\n  },\r\n};\r\n\r\ni18n\r\n  // Подключение бэкенда i18next\r\n  .use(Backend)\r\n  // Автоматическое определение языка\r\n  .use(LanguageDetector)\r\n  // модуль инициализации\r\n  .use(initReactI18next)\r\n  .init({\r\n    resources,\r\n    // Стандартный язык\r\n    fallbackLng: \"ru\",\r\n    debug: false,\r\n    defaultNS: \"cm\",\r\n    // Распознавание и кэширование языковых кук\r\n    detection: {\r\n      order: [\"querystring\", \"cookie\", \"localStorage\"],\r\n      cache: [\"cookie\", \"localStorage\"],\r\n      lookupQuerystring: \"lang\",\r\n      lookupCookie: \"lang\",\r\n      lookupLocalStorage: \"lang\",\r\n    },\r\n    interpolation: {\r\n      escapeValue: false,\r\n    },\r\n  });\r\n\r\nexport default i18n;\r\n","import React, { useEffect, Suspense } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport { HelmetProvider } from \"react-helmet-async\";\nimport { RecoilRoot, useRecoilSnapshot } from \"recoil\";\nimport { ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n\nimport Page from \"./Pages\";\nimport \"./index.css\";\nimport \"./Utils/i18n\";\n\n// function DebugObserver(): React.Node {\n//   const snapshot = useRecoilSnapshot();\n//   useEffect(() => {\n//     console.debug(\"The following atoms were modified:\");\n//     for (const node of snapshot.getNodes_UNSTABLE({ isModified: true })) {\n//       console.debug(\n//         \"DebugObserver--->>>\",\n//         node.key,\n//         snapshot.getLoadable(node)\n//       );\n//     }\n//   }, [snapshot]);\n\n//   return null;\n// }\n\nReactDOM.render(\n  <React.StrictMode>\n    <Suspense fallback={<div>Загрузка...</div>}>\n      <RecoilRoot>\n        {/* <DebugObserver /> */}\n\n        <HelmetProvider>\n          <div className=\"App\">\n            <Router>\n              <Page />\n            </Router>\n            <ToastContainer />\n          </div>\n        </HelmetProvider>\n      </RecoilRoot>\n    </Suspense>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","import axios from \"axios\";\nconst hostURL = \"\";\nconst localURL = \"http://localhost:3000\";\nconst appName = \"/avnumk\";\nconst apiURL = `/api`;\nconst version = `/v1/`;\nconst baseURL = `${hostURL}${appName}${apiURL}${version}`;\n\nlet http = axios.create({\n  baseURL: `${hostURL}${appName}${apiURL}${version}`,\n  timeout: 30000,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n});\n\nexport default http;\nexport { http, localURL, appName, baseURL };\n","import { toast } from \"react-toastify\";\r\n\r\nexport function notify(message, status = \"success\") {\r\n  toast[status](message, {\r\n    position: \"top-right\",\r\n    autoClose: 5000,\r\n    hideProgressBar: false,\r\n    closeOnClick: true,\r\n    pauseOnHover: true,\r\n    draggable: true,\r\n    progress: undefined,\r\n  });\r\n  return 1;\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Scroll_Top_button\":\"topButton_Scroll_Top_button__1Aa94\",\"Scroll_Down_button\":\"topButton_Scroll_Down_button__4Wb6-\"};","// Imports\r\nimport { atom } from \"recoil\";\r\n\r\nconst userDefault = {\r\n  isAuthenticated: false,\r\n  isLoading: false,\r\n  data: null,\r\n};\r\n\r\nexport const userState = atom({\r\n  key: \"userState\",\r\n  default: userDefault,\r\n});\r\n","import http from \"./http\";\n\nconst login = async ({ login, password }) =>\n  await http.post(\"auth/login\", { login, password });\n\nconst check = async () => await http.post(\"auth/check\");\n\nconst logout = async () => await http.get(\"auth/logout\");\n\nexport const AuthService = {\n  login,\n  check,\n  logout,\n};\n"],"sourceRoot":""}