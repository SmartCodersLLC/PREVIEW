{"version":3,"sources":["Components/Modal/Modal.module.css","Components/Spinner/Spinner.module.css","Utils/export.js","State/year.js","State/kafedra.js","State/umk.js","State/rate.js","Service/selector.js","Service/umk.js","Components/Table/TRWrapper.js","Components/Modal/index.js","Components/Spinner/index.js","Containers/UMKContainer.js","Utils/printer.js","Pages/UMKPage.js"],"names":["module","exports","fileTypeXlsx","NOW","Date","getFullYear","FIRST_ID","SECOND_ID","THIRD_ID","FOURTH_ID","FIFTH_ID","SIXTH_ID","FIRST_NAME","SECOND_NAME","THIRD_NAME","FOURTH_NAME","FIFTH_NAME","yearListDefault","value","label","yearListState","atom","key","default","selectedYearState","defaultKafedra","kafedraListState","selectedKafedraState","umkListState","selectedUmkState","umkDetailListState","defaultRate","rateListState","selectedRateState","kafedraList","a","year","http","post","yearList","yearDefault","SelectorService","list","kafedra","rate","detail","id_typeUmk","id_discipline","id_teacher","UMKService","TRWrapper","children","index","rowSpaner","Modal","setIsOpen","title","isOpen","id","useEffect","document","body","style","overflow","className","styles","darkBG","onClick","centered","modal","modalHeader","heading","closeBtn","modalContent","BouncingDotsLoader","props","width","size","height","backgroundColor","color","loader","dot","UMKContainer","t","useTranslation","useRecoilState","userState","setYear","setKafedraList","kafedraListReset","useResetRecoilState","setKafedra","kafedraReset","umkList","setUmkList","umkListReset","umkDetailList","setUmkDetailList","umkDetailListReset","umkSelected","setUmkSelected","rateList","setRate","rateReset","useState","docTypes","setDocTypes","loading","setLoading","defaultSummary","discipline","teacher","summary","setSummary","summaryReset","docTypesReset","getKafedraList","console","time","data","message","error","notify","length","map","id_kafedra","name","timeEnd","getUmkList","sortedData","sortBy","umkGrouped","chain","groupBy","y","p34","disciplines","discipline_name","z","s_t_fio","teachers","teacher_name","teacher_id","types","w","umkName","umks","umk_name","kol","sumBy","uniqBy","item","sort","b","summaryTypes","forEach","type","summa","filter","reduce","partialSum","uniqueTeacherPerDiscipline","flat","uniqueTeachers","Set","getUmkDetails","umkInstance","status","viewList","mimeType","split","pop","printList","window","print","printDetail","divContent","css","documentPrintWindow","getElementById","removeChild","printWindow","createElement","position","top","left","html","appendChild","contentWindow","open","write","close","printDiv","innerHTML","exportList","idTable","fileName","tableID","table_elt","wb","XLSX","table_to_book","excelBuffer","bookType","Blob","FileSaver","exportTableToExcel","to","classNamePrefix","isSearchable","placeholder","onChange","selected","options","d","Spinner","isOpenValue","umkItem","umkIndex","description","p43","encodeURIComponent","url","baseURL","download","includes","view","dIndex","tIndex","rowSpan","docType","docTypeIndex","umk","selectUMK","all","colSpan","UMKPage","charSet"],"mappings":"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","file":"static/js/4.41a44ac9.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"darkBG\":\"Modal_darkBG__H2Rhy\",\"centered\":\"Modal_centered__xRpse\",\"modal\":\"Modal_modal__2aDnM\",\"modalHeader\":\"Modal_modalHeader__1EQ-Q\",\"heading\":\"Modal_heading__1NOny\",\"modalContent\":\"Modal_modalContent__1K7Oo\",\"closeBtn\":\"Modal_closeBtn__2sAmi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loader\":\"Spinner_loader__21JSP\",\"dot\":\"Spinner_dot__2Bh8A\"};","import * as FileSaver from \"file-saver\";\r\nimport * as XLSX from \"xlsx\";\r\n\r\nconst fileTypeXlsx =\r\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\r\n// const fileTypeXlsb = \"application/vnd.ms-excel.sheet.binary.macroEnabled.12\";\r\n\r\n// export Table to Excel\r\nfunction exportTableToExcel(tableID, fileName = \"export_table\") {\r\n  const table_elt = document.getElementById(tableID);\r\n//   const ws = XLSX.utils.table_to_sheet(table_elt);\r\n  const wb = XLSX.utils.table_to_book(table_elt);\r\n\r\n  const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\r\n  const data = new Blob([excelBuffer], { type: fileTypeXlsx });\r\n  FileSaver.saveAs(data, fileName + \".xlsx\");\r\n}\r\n\r\n// export JSON to CSV\r\nfunction exportJsonToCSV(jsonData, fileName = \"export_json\") {\r\n  const ws = XLSX.utils.json_to_sheet(jsonData);\r\n  const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\r\n  const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\r\n  const data = new Blob([excelBuffer], { type: fileTypeXlsx });\r\n  FileSaver.saveAs(data, fileName + \".xlsx\");\r\n}\r\n\r\nexport { exportTableToExcel, exportJsonToCSV };\r\n","// Imports\r\nimport { atom } from \"recoil\";\r\n\r\nconst NOW = new Date().getFullYear();\r\n\r\nconst FIRST_ID = (NOW % 100) - 4;\r\nconst SECOND_ID = (NOW % 100) - 3;\r\nconst THIRD_ID = (NOW % 100) - 2;\r\nconst FOURTH_ID = (NOW % 100) - 1;\r\nconst FIFTH_ID = NOW % 100;\r\nconst SIXTH_ID = (NOW % 100) + 1;\r\n\r\nconst FIRST_NAME = `${NOW - 4}-${NOW - 3}`;\r\nconst SECOND_NAME = `${NOW - 3}-${NOW - 2}`;\r\nconst THIRD_NAME = `${NOW - 2}-${NOW - 1}`;\r\nconst FOURTH_NAME = `${NOW - 1}-${NOW}`;\r\nconst FIFTH_NAME = `${NOW}-${NOW + 1}`;\r\nconst SIXTH_NAME = `${NOW + 1}-${NOW + 2}`;\r\n\r\nconst yearListDefault = [\r\n  { value: FIRST_ID, label: FIRST_NAME },\r\n  { value: SECOND_ID, label: SECOND_NAME },\r\n  { value: THIRD_ID, label: THIRD_NAME },\r\n  { value: FOURTH_ID, label: FOURTH_NAME },\r\n  { value: FIFTH_ID, label: FIFTH_NAME },\r\n  { value: SIXTH_ID, label: SIXTH_NAME },\r\n];\r\n\r\nexport const yearListState = atom({\r\n  key: \"yearListState\",\r\n  default: yearListDefault,\r\n});\r\n\r\nexport const defaultYearState = atom({\r\n  key: \"defaultYearState\",\r\n  default: { value: FIFTH_ID, label: FIFTH_NAME },\r\n});\r\n\r\nexport const selectedYearState = atom({\r\n  key: \"selectedYearState\",\r\n  default: { value: FIFTH_ID, label: FIFTH_NAME },\r\n});\r\n","// Imports\r\nimport { atom } from \"recoil\";\r\n\r\nconst defaultKafedra = { value: 0, label: \"Выберите кафедру\" };\r\n\r\nexport const kafedraListState = atom({\r\n  key: \"kafedraListState\",\r\n  default: [defaultKafedra],\r\n});\r\n\r\nexport const defaultKafedraState = atom({\r\n  key: \"defaultKafedraState\",\r\n  default: defaultKafedra,\r\n});\r\n\r\nexport const selectedKafedraState = atom({\r\n  key: \"selectedKafedraState\",\r\n  default: defaultKafedra,\r\n});\r\n","// Imports\r\nimport { atom } from \"recoil\";\r\n\r\nexport const umkListState = atom({\r\n  key: \"umkListState\",\r\n  default: [],\r\n});\r\n\r\nexport const selectedUmkState = atom({\r\n  key: \"selectedUmkState\",\r\n  default: null,\r\n});\r\n\r\nexport const umkDetailListState = atom({\r\n  key: \"umkDetailListState\",\r\n  default: [],\r\n});","// Imports\r\nimport { atom } from \"recoil\";\r\n\r\nconst defaultRate = { value: 0, label: \"Выберите курс\" };\r\n\r\nconst rateListDefault = [\r\n  { value: 1, label: \"selector.rate1\" },\r\n  { value: 2, label: \"selector.rate2\" },\r\n  { value: 3, label: \"selector.rate3\" },\r\n  { value: 4, label: \"selector.rate4\" },\r\n  { value: 5, label: \"selector.rate5\" },\r\n  { value: 6, label: \"selector.rate6\" },\r\n];\r\n\r\nexport const rateListState = atom({\r\n  key: \"rateListState\",\r\n  default: [defaultRate, ...rateListDefault],\r\n});\r\n\r\nexport const defaultRateState = atom({\r\n  key: \"defaultRateState\",\r\n  default: defaultRate,\r\n});\r\n\r\nexport const selectedRateState = atom({\r\n  key: \"selectedRateState\",\r\n  default: defaultRate,\r\n});\r\n","import http from \"./http\";\r\n\r\nconst kafedraList = async ({ year }) =>\r\n  await http.post(\"select/kafedra/list\", { year });\r\n\r\nconst yearList = async () => await http.post(\"select/year/list\", {});\r\n\r\nconst yearDefault = async () => await http.post(\"select/year/default\", {});\r\n\r\nexport const SelectorService = {\r\n  kafedraList,\r\n  yearList,\r\n  yearDefault,\r\n};\r\n","import http from \"./http\";\r\n\r\nconst list = async ({ year, kafedra, rate }) =>\r\n  await http.post(\"umk/list\", { year, kafedra, rate });\r\n\r\nconst detail = async ({ rate, id_typeUmk, id_discipline, id_teacher }) =>\r\n  await http.post(\"umk/detail\", {\r\n    rate,\r\n    id_discipline,\r\n    id_typeUmk,\r\n    id_teacher,\r\n  });\r\n\r\nexport const UMKService = {\r\n  list,\r\n  detail,\r\n};\r\n","//goto top button\r\n// Language: javascript\r\n// Path: UMK_Front\\src\\Components\\topButton.js\r\n\r\nimport React from \"react\";\r\n\r\nexport default function TRWrapper({ children, index, rowSpaner }) {\r\n  if (index == 0)\r\n    return (\r\n      <tr>\r\n        {rowSpaner} {children}\r\n      </tr>\r\n    );\r\n  return <tr>{children}</tr>;\r\n}\r\n","// @src/components/Modal/index.js\r\n\r\nimport React, { useEffect } from \"react\";\r\nimport styles from \"./Modal.module.css\";\r\n\r\nconst Modal = ({ setIsOpen, title, children, isOpen, id }) => {\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      document.body.style.overflow = \"hidden\";\r\n    } else {\r\n      document.body.style.overflow = \"unset\";\r\n    }\r\n    return () => (document.body.style.overflow = \"unset\");\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      document.body.style.overflow = \"hidden\";\r\n    } else {\r\n      document.body.style.overflow = \"unset\";\r\n    }\r\n  }, [isOpen]);\r\n\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className={styles.darkBG} onClick={() => setIsOpen(false)} />\r\n      <div className={styles.centered}>\r\n        <div className={styles.modal} id={id}> \r\n          <div className={styles.modalHeader}>\r\n            <h5 className={`${styles.heading} text-center`}>{title}</h5>\r\n          </div>\r\n          <button className={`${styles.closeBtn} no-print`} onClick={() => setIsOpen(false)}>\r\n            <i className=\"fas fa-close\"></i>\r\n          </button>\r\n          <div className={styles.modalContent}>{children}</div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Modal;\r\n","// @src/components/Spinner/index.js\r\n\r\nimport React from \"react\";\r\nimport styles from \"./Spinner.module.css\";\r\n\r\nconst BouncingDotsLoader = (props) => {\r\n  const width = props.size || \"16px\";\r\n  const height = props.size || \"16px\";\r\n  const backgroundColor = props.color || \"#888\";\r\n\r\n  return (\r\n    <div className={styles.loader}>\r\n      <div\r\n        className={styles.dot}\r\n        style={{ width, height, backgroundColor }}\r\n      ></div>\r\n      <div\r\n        className={styles.dot}\r\n        style={{ width, height, backgroundColor }}\r\n      ></div>\r\n      <div\r\n        className={styles.dot}\r\n        style={{ width, height, backgroundColor }}\r\n      ></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BouncingDotsLoader;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRecoilState, useResetRecoilState } from \"recoil\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport Select from \"react-select\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { chain, sortBy, sumBy, uniqBy } from \"lodash\";\r\n\r\nimport { notify } from \"../Utils/notify\";\r\nimport { exportTableToExcel } from \"../Utils/export\";\r\nimport { printDiv, printDocument } from \"../Utils/printer\";\r\nimport { userState } from \"../State/user\";\r\nimport { yearListState, selectedYearState } from \"../State/year\";\r\nimport { kafedraListState, selectedKafedraState } from \"../State/kafedra\";\r\nimport {\r\n  umkListState,\r\n  selectedUmkState,\r\n  umkDetailListState,\r\n} from \"../State/umk\";\r\nimport { rateListState, selectedRateState } from \"../State/rate\";\r\n\r\nimport { SelectorService } from \"../Service/selector\";\r\nimport { UMKService } from \"../Service/umk\";\r\nimport TRWrapper from \"../Components/Table/TRWrapper\";\r\nimport Modal from \"../Components/Modal\";\r\nimport Spinner from \"../Components/Spinner\";\r\nimport \"../Styles/UMKContainer.css\";\r\nimport { baseURL } from \"../Service/http\";\r\n\r\nexport function UMKContainer() {\r\n  const { t } = useTranslation();\r\n\r\n  const [user, setUser] = useRecoilState(userState);\r\n\r\n  const [yearList, setYearList] = useRecoilState(yearListState);\r\n  const [year, setYear] = useRecoilState(selectedYearState);\r\n\r\n  const [kafedraList, setKafedraList] = useRecoilState(kafedraListState);\r\n  const kafedraListReset = useResetRecoilState(kafedraListState);\r\n  const [kafedra, setKafedra] = useRecoilState(selectedKafedraState);\r\n  const kafedraReset = useResetRecoilState(selectedKafedraState);\r\n\r\n  const [umkList, setUmkList] = useRecoilState(umkListState);\r\n  const umkListReset = useResetRecoilState(umkListState);\r\n  const [umkDetailList, setUmkDetailList] = useRecoilState(umkDetailListState);\r\n  const umkDetailListReset = useResetRecoilState(umkDetailListState);\r\n  const [umkSelected, setUmkSelected] = useRecoilState(selectedUmkState);\r\n  const umkSelectedReset = useResetRecoilState(selectedUmkState);\r\n\r\n  const [rateList, setRateList] = useRecoilState(rateListState);\r\n  const [rate, setRate] = useRecoilState(selectedRateState);\r\n  const rateReset = useResetRecoilState(selectedRateState);\r\n\r\n  const [docTypes, setDocTypes] = useState([]);\r\n  const [loading, setLoading] = useState(null);\r\n  const defaultSummary = { discipline: 0, teacher: \"0/0\" };\r\n  const [summary, setSummary] = useState(defaultSummary);\r\n\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const summaryReset = () => setSummary(defaultSummary);\r\n  const docTypesReset = () => setDocTypes([]);\r\n\r\n  const handleYear = (selected) => {\r\n    setYear(selected);\r\n  };\r\n  const handleKafedra = (selected) => {\r\n    setKafedra(selected);\r\n  };\r\n  const handleRate = (selected) => {\r\n    if (kafedra.value === 0 && kafedraList.length > 1) {\r\n      notify(t(\"selector.chooseDeparment\"), \"error\");\r\n      return;\r\n    }\r\n    setRate(selected);\r\n  };\r\n\r\n  const getKafedraList = async () => {\r\n    setLoading(t(\"umk:report.load.kafedra\"));\r\n    console.time(\"kafedra\");\r\n    const { data, message, error } = await SelectorService.kafedraList({\r\n      year: year.value,\r\n    });\r\n    if (error) {\r\n      notify(message, \"error\");\r\n    }\r\n    if (data.length === 0) {\r\n      notify(t(\"selector.noKafedra\"), \"error\");\r\n      setLoading(null);\r\n      return;\r\n    }\r\n    const kafedraList = data.map(({ id_kafedra, name }) => ({\r\n      value: id_kafedra,\r\n      label: name,\r\n    }));\r\n    setKafedraList(kafedraList);\r\n\r\n    setLoading(null);\r\n    console.timeEnd(\"kafedra\");\r\n  };\r\n\r\n  const getUmkList = async () => {\r\n    if (kafedraList.length < 2 || kafedra.value === 0 || rate.value === 0) {\r\n      return;\r\n    }\r\n    console.time(\"getUmkList\");\r\n    setLoading(t(\"umk:report.load.umk\"));\r\n    const { data,   message, error } = await UMKService.list({\r\n      year: year.value,\r\n      kafedra: kafedra.value,\r\n      rate: rate.value,\r\n    });\r\n    setLoading(null);\r\n    console.timeEnd(\"getUmkList\");\r\n    if (error) {\r\n      // Ошибка при получении списка УМК\r\n      notify(message, \"error\");\r\n      setUmkList([]);\r\n      setDocTypes([]);\r\n      return;\r\n    }\r\n\r\n    if (data?.length === 0) {\r\n      // Если нет данных по дисциплинам и преподавателям, то выводим пустую таблицу\r\n      notify(t(\"umk:report.noData\"), \"error\");\r\n      setUmkList([]);\r\n      setDocTypes([]);\r\n      return;\r\n    }\r\n    setLoading(t(\"umk:report.load.render\"));\r\n    console.time(\"render\");\r\n    // Сортируем по названию дисциплины, преподавателя\r\n    const sortedData = sortBy(data, [\"p34\", \"s_t_fio\"], [\"asc\", \"asc\"]);\r\n    // Группируем по дисциплине и преподавателю для отображения в таблице\r\n    const umkGrouped = chain(sortedData)\r\n      .groupBy((y) => y.p34)\r\n      .map((disciplines, key) => ({\r\n        discipline_name: key,\r\n        disciplines: chain(disciplines)\r\n          .groupBy((z) => z.s_t_fio)\r\n          .map((teachers, key) => ({\r\n            teacher_name: key,\r\n            teacher_id: teachers[0].id_teacher,\r\n            types: chain(teachers)\r\n              .groupBy((w) => w.umkName)\r\n              .map((umks, key) => ({\r\n                umk_name: key,\r\n                kol: sumBy(umks, \"kol\"),\r\n                umks: umks,\r\n              }))\r\n              .value(),\r\n          }))\r\n          .value(),\r\n      }))\r\n      .value();\r\n\r\n    setUmkList(umkGrouped);\r\n    // Типы УМК\r\n    const types = uniqBy(data, (item) => item.umkName)\r\n      .sort((a, b) => a.sort > b.sort)\r\n      .map((item) => item.umkName);\r\n\r\n    // Количество УМК по типу\r\n    let summaryTypes = {};\r\n    types.forEach((type) => {\r\n      const filtered = data.filter((item) => item.umkName === type);\r\n      let summa = filtered.reduce((partialSum, a) => {\r\n        if (a.id_teacher == -1) {\r\n          // Количесиво незаполненых УМК и преподавателей\r\n          return (partialSum += 1);\r\n        } else {\r\n          // Суммируем количество УМК\r\n          summaryTypes[\"all\"] = summaryTypes[\"all\"]\r\n            ? summaryTypes[\"all\"] + a.kol\r\n            : a.kol;\r\n          // Суммируем количество УМК по типу\r\n          return partialSum + a.kol;\r\n        }\r\n      }, 0);\r\n      summaryTypes[type] = summa;\r\n    });\r\n    setDocTypes(types);\r\n\r\n    // Количество преподавателей  уникальных по дисциплине\r\n    const uniqueTeacherPerDiscipline = umkGrouped\r\n      .map((item) =>\r\n        item.disciplines.map((discipline) => discipline.teacher_id)\r\n      )\r\n      .flat()\r\n      .filter((item) => item > 0);\r\n    // Количество преподавателей  уникальных по кафедре\r\n    const uniqueTeachers = new Set(uniqueTeacherPerDiscipline);\r\n\r\n    //  Итоговый отчет\r\n    setSummary({\r\n      discipline: umkGrouped.length,\r\n      teacher: `${uniqueTeachers.size} / ${uniqueTeacherPerDiscipline.length}`,\r\n      ...summaryTypes,\r\n    });\r\n\r\n    setLoading(null);\r\n    console.timeEnd(\"render\");\r\n  };\r\n\r\n  const getUmkDetails = async (umkInstance) => {\r\n    console.time(\"getUmkDetails\");\r\n    setLoading(t(\"umk:report.load.details\"));\r\n    const { data, status, message, error } = await UMKService.detail({\r\n      rate: rate.value,\r\n      id_discipline: umkInstance.id_discipline,\r\n      id_typeUmk: umkInstance.id_typeUmk,\r\n      id_teacher: umkInstance.id_teacher,\r\n    });\r\n    setLoading(null);\r\n    console.timeEnd(\"getUmkDetails\");\r\n    if (error) {\r\n      // Ошибка при получении деталей УМК\r\n      notify(message, \"error\");\r\n      setUmkDetailList([]);\r\n      return;\r\n    }\r\n    if (status === 404) {\r\n      // Если нет данных по дисциплинам и преподавателям, то выводим пустую таблицу\r\n      notify(t(\"umk:report.noData\"), \"error\");\r\n      setUmkDetailList([]);\r\n      return;\r\n    }\r\n    setUmkDetailList(data);\r\n  };\r\n\r\n  const setIsOpenHandler = (isOpenValue) => {\r\n    setIsOpen(isOpenValue);\r\n  };\r\n\r\n  const selectUMK = (umk) => {\r\n    umkDetailListReset();\r\n    setIsOpen(true);\r\n    setUmkSelected(umk);\r\n    getUmkDetails(umk);\r\n  };\r\n\r\n  const viewList = [\r\n    \"csv\",\r\n    \"xlsx\",\r\n    \"jpg\",\r\n    \"jpeg\",\r\n    \"gif\",\r\n    \"gif\",\r\n    \"png\",\r\n    \"pdf\",\r\n    \"docx\",\r\n    \"mp3\",\r\n    \"webm\",\r\n    \"mp4\",\r\n    \"wexbim\",\r\n  ];\r\n  const isAllowedView = (type) => {\r\n    return viewList.includes(type);\r\n  };\r\n\r\n  const download = ({ id, name }) => {\r\n    const fileName = `${id}_${encodeURIComponent(name)}`;\r\n    const url = `${baseURL}/umk/download?file=${fileName}`;\r\n    window.open(url, \"_blank\");\r\n  };\r\n  const view = ({ id, name }) => {\r\n    const fileName = `${id}_${encodeURIComponent(name)}`;\r\n    const type = mimeType(fileName);\r\n    const url = `/avnumk/view?file=${fileName}&type=${type}`;\r\n    window.open(url, \"_blank\");\r\n  };\r\n  const mimeType = (name) => {\r\n    return name.split(\".\").pop();\r\n  };\r\n\r\n  const printList = () => {\r\n    if (kafedra.value && rate.value && year.value) {\r\n      printDocument();\r\n    } else {\r\n      notify(t(\"umk:report.noData\"), \"error\");\r\n    }\r\n  };\r\n\r\n  const printDetail = () => {\r\n    if (umkSelected) {\r\n      const css = `h5 {text-align: center; margin: 0; margin-bottom: 20px; font-size: 18px;}\r\n      table { border-collapse: collapse; background-color: #fff; width: 100%; font-size: 14px;}\r\n      td.break { float: left; line-height: 22px;}\r\n      td, th { padding: 5px 10px; height: 35px; border: 1px solid #606060 !important;}\r\n      table thead tr, table tbody td, small { color: black !important; }\r\n      .no-print, .no-print-child, .no-print-child * { display: none !important; }\r\n      p { margin: 0; padding: 5px; }\r\n      .text-center { text-align: center;}\r\n      .text-left { text-align: left;}\r\n      .text-right { text-align: right;}`;\r\n      const html = document.getElementById(\"modalDetail\").innerHTML;\r\n      printDiv(html, t(\"head.umk\"), css);\r\n    } else {\r\n      notify(t(\"umk:report.noData\"), \"error\");\r\n    }\r\n  };\r\n\r\n  const exportList = (idTable, fileName) => {\r\n    exportTableToExcel(idTable, fileName);\r\n  };\r\n\r\n  useEffect(() => {\r\n    kafedraReset();\r\n    kafedraListReset();\r\n    rateReset();\r\n    umkListReset();\r\n    summaryReset();\r\n    docTypesReset();\r\n    getKafedraList();\r\n  }, [year]);\r\n\r\n  useEffect(() => {\r\n    umkListReset();\r\n    rateReset();\r\n    summaryReset();\r\n    docTypesReset();\r\n  }, [kafedra]);\r\n\r\n  useEffect(() => {\r\n    umkListReset();\r\n    summaryReset();\r\n    docTypesReset();\r\n    getUmkList();\r\n  }, [rate]);\r\n\r\n  return (\r\n    <div className=\"UMKContainer\">\r\n      <div className=\"Selectors_Wrapper no-print\">\r\n        <NavLink to=\"/avnumk/\">\r\n          <button title={t(\"back\")}>\r\n            <i className=\"fas fa-arrow-left\"></i>\r\n          </button>\r\n        </NavLink>\r\n        <Select\r\n          className=\"Select\"\r\n          classNamePrefix=\"my_select\"\r\n          value={year}\r\n          isSearchable={false}\r\n          placeholder={t(\"selector.choose\")}\r\n          onChange={handleYear}\r\n          options={yearList?.map((d) => d)}\r\n        />\r\n        <Select\r\n          className=\"Select\"\r\n          classNamePrefix=\"my_select\"\r\n          value={kafedra}\r\n          isSearchable={true}\r\n          placeholder={t(\"cm:selector.choose\")}\r\n          onChange={handleKafedra}\r\n          options={kafedraList?.map((d) => {\r\n            return { value: d.value, label: t(d.label) };\r\n          })}\r\n        />\r\n        <Select\r\n          className=\"Select\"\r\n          classNamePrefix=\"my_select\"\r\n          value={rate}\r\n          isSearchable={false}\r\n          placeholder={t(\"cm:selector.choose\")}\r\n          onChange={handleRate}\r\n          options={rateList?.map((d) => {\r\n            return { value: d.value, label: t(d.label) };\r\n          })}\r\n        />\r\n\r\n        <div>\r\n          {loading ? (\r\n            <>\r\n              <Spinner size={\"15px\"} color={\"blue\"} />\r\n              {loading}\r\n            </>\r\n          ) : null}\r\n        </div>\r\n        <div className=\"flex\">\r\n          {umkList?.length > 0 && !isOpen ? (\r\n            <>\r\n              <button\r\n                className=\"Button\"\r\n                title={t(\"export\")}\r\n                onClick={() => {\r\n                  exportList(\r\n                    \"listTable\",\r\n                    `УМК_${year?.label}_${kafedra.label}_${rate.label}`\r\n                  );\r\n                }}\r\n              >\r\n                <i className=\"fa fa-file-export\"></i>\r\n              </button>\r\n\r\n              <button\r\n                className=\"Button\"\r\n                title={t(\"print\")}\r\n                onClick={() => {\r\n                  printList();\r\n                }}\r\n              >\r\n                <i className=\"fas fa-print\"></i>\r\n              </button>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n\r\n      <Modal\r\n        title={umkSelected?.umkName}\r\n        isOpen={isOpen}\r\n        setIsOpen={setIsOpenHandler}\r\n        id={\"modalDetail\"}\r\n      >\r\n        <div>\r\n          <div className=\"text-left\">\r\n            <p>\r\n              <small>\r\n                {t(\"umk:report.kafedra\")}: {kafedra.label}\r\n              </small>\r\n            </p>\r\n            <p>\r\n              <small>\r\n                {t(\"umk:report.rate\")}: {umkSelected?.rate}\r\n              </small>\r\n            </p>\r\n            <p>\r\n              <small>\r\n                {t(\"umk:report.discipline\")}: {umkSelected?.p34}\r\n              </small>\r\n            </p>\r\n            <p>\r\n              <small>\r\n                {t(\"umk:report.teacher\")}: {umkSelected?.s_t_fio}\r\n              </small>\r\n            </p>\r\n            <br />\r\n            <div className=\"no-print flex\">\r\n              {umkDetailList?.length > 0 && isOpen ? (\r\n                <>\r\n                  <button\r\n                    className=\"Button\"\r\n                    title={t(\"export\")}\r\n                    onClick={() => {\r\n                      exportList(\r\n                        \"detailTable\",\r\n                        `УМК_${umkSelected?.umkName}_${kafedra.label}_${rate.label}_${umkSelected?.p34}_${umkSelected?.s_t_fio}`\r\n                      );\r\n                    }}\r\n                  >\r\n                    <i className=\"fa fa-file-export\"></i>\r\n                  </button>\r\n                  <button\r\n                    className=\"Button\"\r\n                    title={t(\"print\")}\r\n                    onClick={() => {\r\n                      printDetail();\r\n                    }}\r\n                  >\r\n                    <i className=\"fas fa-print\"></i>\r\n                  </button>\r\n                </>\r\n              ) : null}\r\n            </div>\r\n          </div>\r\n\r\n          {umkDetailList.length > 0 ? (\r\n            <>\r\n              <table id=\"detailTable\">\r\n                <thead>\r\n                  <tr>\r\n                    <th width=\"5%\">№</th>\r\n                    <th>{t(\"umk:report.table.name\")}</th>\r\n                    <th>{t(\"umk:report.table.description\")}</th>\r\n                    <th>{t(\"umk:report.table.semester\")}</th>\r\n                    <th>{t(\"umk:report.table.file\")}</th>\r\n                    <th className=\"no-print\">\r\n                      {t(\"umk:report.table.download\")}\r\n                    </th>\r\n                    <th className=\"no-print\">{t(\"umk:report.table.view\")}</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {umkDetailList.map((umkItem, umkIndex) => (\r\n                    <tr key={umkItem.id}>\r\n                      <td>{umkIndex + 1}</td>\r\n                      <td>{umkItem.name}</td>\r\n                      <td>{umkItem.description}</td>\r\n                      <td>{umkItem.p43}</td>\r\n                      <td>{umkItem.fileName}</td>\r\n                      <td className=\"no-print\">\r\n                        <span\r\n                          className=\"pointer\"\r\n                          title={t(\"umk:report.table.downloadTitle\")}\r\n                          onClick={() =>\r\n                            download({\r\n                              id: umkItem.id,\r\n                              name: umkItem.fileName,\r\n                            })\r\n                          }\r\n                        >\r\n                          <i className=\"fas fa-download\"></i>\r\n                        </span>\r\n                      </td>\r\n\r\n                      <td className=\"no-print\">\r\n                        {isAllowedView(mimeType(umkItem.fileName)) ? (\r\n                          <span\r\n                            className=\"pointer\"\r\n                            title={t(\"umk:report.table.viewTitle\")}\r\n                            onClick={() =>\r\n                              view({\r\n                                id: umkItem.id,\r\n                                name: umkItem.fileName,\r\n                              })\r\n                            }\r\n                          >\r\n                            {\" \"}\r\n                            <i className=\"fas fa-eye\"></i>\r\n                          </span>\r\n                        ) : null}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n      </Modal>\r\n\r\n      <div className=\"A4\" id=\"A4\">\r\n        <div className=\"text-left\">\r\n          <p>\r\n            <small>\r\n              {t(\"umk:report.year\")}: {year.label}\r\n            </small>\r\n          </p>\r\n          <p>\r\n            <small>\r\n              {t(\"umk:report.kafedra\")}: {kafedra.label}\r\n            </small>\r\n          </p>\r\n          <p>\r\n            <small>\r\n              {t(\"umk:report.rate\")}: {rate.label}\r\n            </small>\r\n          </p>\r\n          <br />\r\n        </div>\r\n\r\n        <table id=\"listTable\">\r\n          <thead>\r\n            <tr>\r\n              <th width=\"5%\">{t(\"umk:report.discipline\")}</th>\r\n              <th>{t(\"umk:report.teacher\")}</th>\r\n              {docTypes.map((type) => (\r\n                <th key={type}>{type}</th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {umkList?.map((discipline, dIndex) =>\r\n              discipline.disciplines.map((teacher, tIndex) => (\r\n                <TRWrapper\r\n                  index={tIndex}\r\n                  rowSpaner={\r\n                    <td rowSpan={discipline.disciplines.length}>\r\n                      {discipline.discipline_name}\r\n                    </td>\r\n                  }\r\n                >\r\n                  <td>{teacher.teacher_name}</td>\r\n                  {docTypes.map((docType, docTypeIndex) => {\r\n                    let umk = teacher.types.filter(\r\n                      (t) => t.umk_name == docType\r\n                    )[0];\r\n                    if (umk?.umks.length)\r\n                      return (\r\n                        <td key={docTypeIndex + \"\" + umk?.umk_name}>\r\n                          <div\r\n                            className=\"umkCount\"\r\n                            onClick={() => selectUMK(umk?.umks[0])}\r\n                          >\r\n                            {umk?.kol}\r\n                          </div>\r\n                        </td>\r\n                      );\r\n                    else return <td>-</td>;\r\n                  })}\r\n                </TRWrapper>\r\n              ))\r\n            )}\r\n            {summary.all && (\r\n              <>\r\n                <tr>\r\n                  <td>\r\n                    <b>{t(\"umk:report.summary.disciplines\")}:</b>{\" \"}\r\n                    {summary?.discipline}\r\n                  </td>\r\n                  <td>\r\n                    {t(\"umk:report.summary.teachers\")} <br /> {summary?.teacher}\r\n                  </td>\r\n                  {docTypes.map((type) => (\r\n                    <td key={type}>\r\n                      {type} <br />\r\n                      {summary[type]}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n\r\n                <tr>\r\n                  <td colSpan={2 + docTypes?.length}>\r\n                    {t(\"umk:report.summary.all\")}: {summary?.all}\r\n                  </td>\r\n                </tr>\r\n              </>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// print  HTML\r\nfunction printDiv(divContent, title = \"Printer\", css = \"\") {\r\n  const documentPrintWindow = document.getElementById(\"printWindow\");\r\n  if (documentPrintWindow) {\r\n    document.body.removeChild(documentPrintWindow);\r\n  }\r\n  const printWindow = document.createElement(\"iframe\");\r\n  printWindow.style.position = \"absolute\";\r\n  printWindow.style.top = \"-1000px\";\r\n  printWindow.style.left = \"-1000px\";\r\n  printWindow.id = \"printWindow\";\r\n  const html = `<html><head><title>${title}</title></head><body><style>${css}</style>${divContent}</body></html>`;\r\n  document.body.appendChild(printWindow);\r\n  printWindow.contentWindow.document.open();\r\n  printWindow.contentWindow.document.write(html);\r\n  printWindow.contentWindow.document.close();\r\n  printWindow.contentWindow.print();\r\n}\r\n\r\n// print  Document\r\nfunction printDocument() {\r\n  window.print();\r\n}\r\n\r\nexport { printDiv, printDocument };\r\n","import React from \"react\";\r\nimport { Helmet } from \"react-helmet-async\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { UMKContainer } from \"../Containers/UMKContainer\";\r\n\r\nexport default function UMKPage() {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <div className=\"Main\">\r\n      <Helmet>\r\n        <meta charSet=\"utf-8\" />\r\n        <title>\r\n          {t(\"head.umk\")} | {t(\"head.appTitle\")}\r\n        </title>\r\n      </Helmet>\r\n      <UMKContainer />\r\n    </div>\r\n  );\r\n}\r\n"],"sourceRoot":""}